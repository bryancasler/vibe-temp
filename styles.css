:root {
    --bg: #0e1117;
    --card: #161b22;
    --ink: #e6edf3;
    --muted: #9aa4af;
    --accent: #6ea8fe; /* shade vibe color */
    --warm: #ffb86b;   /* sun vibe color */
    --good: #45d483;   /* current time color */
  }
  
  * { box-sizing: border-box; }
  body {
    margin: 0; padding: 20px; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
    color: var(--ink); background: radial-gradient(1200px 600px at 10% -10%, #1b2330 0%, #0e1117 60%) fixed;
  }
  .vibe-card {
    max-width: 980px; margin: 0 auto; background: var(--card); border: 1px solid #263040; border-radius: 14px; padding: 16px 16px 12px;
    box-shadow: 0 10px 30px rgba(0,0,0,.35);
  }
  header { display: flex; align-items: baseline; gap: 10px; margin-bottom: 8px; }
  h2 { margin: 0; font-weight: 700; letter-spacing: .2px; }
  .sub { color: var(--muted); margin: 0; }
  
  .results {
    display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin: 12px 0 8px;
  }
  .card {
    background: #0f1420; border: 1px solid #263040; border-radius: 10px; padding: 12px; display: grid; gap: 6px;
  }
  .card h3 { margin: 0; font-size: 14px; color: var(--muted); }
  .big { font-size: 42px; font-weight: 800; letter-spacing: .5px; }
  #nowTime { color: var(--good); }
  #shade { color: var(--accent); }
  #sun { color: var(--warm); }
  .label { font-size: 13px; color: var(--muted); min-height: 1.2em; }
  
  .timeline {
    margin-top: 8px;
    background: #0f1420;
    border: 1px solid #263040;
    border-radius: 10px;
    padding: 12px;
    max-height: 260px;
  }
  .timeline-title { margin: 0 0 6px 0; color: #9aa4af; font-size: 14px; }
  .timeline canvas { width: 100%; height: 100%; max-height: 260px; }
  .tiny { color: var(--muted); font-size: 12px; text-align: right; margin: 6px 0 4px; }
  
  /* Advanced Configuration */
  .advanced { margin-top: 12px; }
  .advanced > summary {
    cursor: pointer; padding: 8px 10px; border: 1px solid #263040; border-radius: 10px; background: #0f1420; color: var(--ink);
    list-style: none; outline: none; user-select: none;
    display: inline-flex; align-items: center; gap: 6px; /* caret snug after text */
  }
  /* Hide native marker */
  .advanced > summary::-webkit-details-marker, .advanced > summary::marker { display: none; content: ""; }
  /* Custom caret */
  .advanced > summary::after {
    content: "â–¶"; font-size: 13px; color: var(--muted); transform-origin: center; transform: rotate(0deg);
    transition: transform 250ms ease, color 200ms ease, opacity 200ms ease; opacity: 0.9;
  }
  .advanced > summary:hover::after { color: #c6d0db; opacity: 1; }
  .advanced[open] > summary::after { transform: rotate(90deg); color: #c6d0db; opacity: 1; animation: caret-pop 250ms ease; }
  @keyframes caret-pop { 0%{transform:rotate(90deg) scale(.92)}60%{transform:rotate(90deg) scale(1.08)}100%{transform:rotate(90deg) scale(1)} }
  
  .advanced[open] > summary { border-bottom-left-radius: 0; border-bottom-right-radius: 0; }
  .advanced > *:not(summary) { border: 1px solid #263040; border-top: none; padding: 12px; border-bottom-left-radius: 10px; border-bottom-right-radius: 10px; background: #0f1420; }
  
  /* Scheduler panel */
  .scheduler { margin-top: 10px; }
  .schedule-grid {
    display: grid;
    grid-template-columns: repeat(5, minmax(0, 1fr));
    gap: 10px;
    align-items: center;
  }
  .sched-item { background: #0b111c; border: 1px solid #1b2433; border-radius: 8px; padding: 10px; }
  .sched-label { font-size: 12px; color: var(--muted); margin-bottom: 4px; }
  .sched-value { font-size: 14px; color: var(--ink); }
  .inline { display: inline-flex; align-items: center; gap: 8px; color: var(--ink); }
  .sched-actions { grid-column: span 1; text-align: right; }
  .scheduler button { cursor: pointer; background: linear-gradient(180deg, #1b61ff, #1247c1); border: 1px solid #1b61ff; color: var(--ink); border-radius: 8px; padding: 8px 10px; }
  
  .grid {
    display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 12px;
  }
  .row { display: flex; align-items: center; gap: 10px; margin-top: 8px; flex-wrap: wrap; }
  label { display: grid; gap: 6px; font-size: 14px; color: var(--muted); }
  input, select, button {
    background: #0f1420; color: var(--ink); border: 1px solid #263040; border-radius: 8px; padding: 10px 12px; font-size: 14px;
  }
  input[type="range"] { padding: 0; }
  button { cursor: pointer; background: linear-gradient(180deg, #1b61ff, #1247c1); border-color: #1b61ff; }
  button:active { transform: translateY(1px); }
  .status { color: var(--muted); font-size: 13px; }
  
  .formula-title { margin: 0 0 6px 0; color: var(--muted); font-weight: 600; font-size: 13px; }
  pre { margin: 6px 0 0; padding: 8px; background: #0b0f18; border: 1px solid #1b2433; border-radius: 8px; color: #d7dde8; overflow: auto; }
  
  @media (max-width: 980px) {
    .schedule-grid { grid-template-columns: repeat(2, 1fr); }
  }
  @media (max-width: 880px) {
    .grid, .results { grid-template-columns: 1fr; }
  }
  